@(matchNav: controllers.MatchNav, comp: model.Competition)
@import implicits.Football._

@defining(matchNav.theMatch){fMatch =>

<!-- {microapp-css:@Static("microapp/style.css")} -->
<!-- {microapp-javascript:@Static("microapp/autorefresh.js")} -->

<div class="m-sport">

  @if(matchNav.hasReports){
    <div id="tabs" >
        <ol class="tabs fake" >
            @matchNav.matchReport.map{ matchReport => @report(matchReport, "Guardian report") }
            @matchNav.minByMin.map{ minByMin => @report(minByMin, "Min-by-min") }
            @report(matchNav.stats, "Match facts")
        </ol>
    </div>
  }

    <div id="match-stats-summary" data="@fMatch.id" data-ajax-url="[URL]">
        <h2 data="@comp.id">@comp.fullName</h2>
        <table>
            <tbody>
            <tr>
                <th data="@fMatch.homeTeam.id" >@(fMatch.homeTeam.name) @{fMatch.homeTeam.score getOrElse 0}</th>
                <td>
                    @scorers(fMatch.homeTeam.scorers)
                </td>
            </tr>
            <tr class="away">
                <th data="@fMatch.awayTeam.id">@(fMatch.awayTeam.name) @{fMatch.awayTeam.score getOrElse 0}</th>
                <td>
                    @scorers(fMatch.awayTeam.scorers)
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
}

@report(trail: Trail, text: String) = {
  @if(matchNav.currentPage.exists(_.url == trail.url)){
    <li><a class="active" href="#">@text</a></li>
  } else {
    <li><a class="inactive" href="@trail.url">@text</a></li>
  }
}

@scorers(scorers: Option[String]) = {
  <ul>
    @{
      scorers.map { scors : String =>
        val all = scors.split(",")
        all map { s =>
          val noBrace = s.replace("(", " ").replace(")", "")
          val scorer = if (s == all.last) noBrace else noBrace + ", "
          <li>{scorer}</li>
        }
      }
    }
  </ul>
}